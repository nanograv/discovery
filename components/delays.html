
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Deterministic Delays &#8212; Discovery 0.5 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=db78e746"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'components/delays';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Model" href="../guide/data_model.html" />
    <link rel="prev" title="GP Priors and Spectra" href="priors_spectra.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Discovery 0.5 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/curn_example.html">
    How best to run a CURN model
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/basic_likelihood.html">
    Basic Likelihood
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../tutorials/optimal_statistic.html">
    Optimal Statistic
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../tutorials/simulations.html">
    Simulations
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="noise_signals.html">
    Noise and Signal Components
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="priors_spectra.html">
    GP Priors and Spectra
  </a>
</li>


<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="#">
    Deterministic Delays
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../guide/data_model.html">
    Data Model
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../guide/pulsar_data.html">
    Pulsar Data
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../advanced/conditional_sampling.html">
    Conditional Sampling of GP Coefficients
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../examples.html">
    Examples
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/curn_example.html">
    How best to run a CURN model
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quickstart.html">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/basic_likelihood.html">
    Basic Likelihood
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/optimal_statistic.html">
    Optimal Statistic
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/simulations.html">
    Simulations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="noise_signals.html">
    Noise and Signal Components
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="priors_spectra.html">
    GP Priors and Spectra
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Deterministic Delays
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/data_model.html">
    Data Model
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/pulsar_data.html">
    Pulsar Data
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../advanced/conditional_sampling.html">
    Conditional Sampling of GP Coefficients
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Deterministic Delays</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="deterministic-delays">
<h1>Deterministic Delays<a class="headerlink" href="#deterministic-delays" title="Link to this heading">#</a></h1>
<p>Discovery provides deterministic delay functions for modeling known physical effects that modify
the observed timing residuals. These delays are added directly to the likelihood model and can
have free or fixed parameters.</p>
<section id="creating-delay-functions">
<h2>Creating Delay Functions<a class="headerlink" href="#creating-delay-functions" title="Link to this heading">#</a></h2>
<section id="the-makedelay-function">
<h3>The <code class="docutils literal notranslate"><span class="pre">makedelay</span></code> Function<a class="headerlink" href="#the-makedelay-function" title="Link to this heading">#</a></h3>
<p>Create a deterministic delay component:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">delayfunc</span><span class="p">,</span> <span class="n">common</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;delay&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This wraps a JAX-compatible delay function <code class="docutils literal notranslate"><span class="pre">delayfunc</span></code> to create a component that can be
included in a likelihood.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">psr</span></code>: Pulsar object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delayfunc</span></code>: JAX function that computes the delay</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">common</span></code>: List of parameter names shared across pulsars</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Parameter name prefix</p></li>
</ul>
<p><strong>Delay Function Signature:</strong></p>
<p>The delay function must have signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">delayfunc</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute delay in seconds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    delay : array</span>
<span class="sd">        Timing delay at each TOA (seconds)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">...</span>
</pre></div>
</div>
<p><strong>Automatic Parameter Passing:</strong></p>
<p>If the first arguments of <code class="docutils literal notranslate"><span class="pre">delayfunc</span></code> are defined attributes of <code class="docutils literal notranslate"><span class="pre">psr</span></code> (like <code class="docutils literal notranslate"><span class="pre">toas</span></code> or <code class="docutils literal notranslate"><span class="pre">freqs</span></code>),
they are automatically passed and excluded from the parameter list. These must come before all
variable parameters.</p>
<p><strong>Parameter Naming:</strong></p>
<p>Parameters are named <code class="docutils literal notranslate"><span class="pre">{psrname}_{name}_{argX}</span></code> unless included in the <code class="docutils literal notranslate"><span class="pre">common</span></code> list.</p>
<p>See <a class="reference internal" href="../api/signals.html#discovery.signals.makedelay" title="discovery.signals.makedelay"><code class="xref py py-func docutils literal notranslate"><span class="pre">makedelay()</span></code></a>.</p>
</section>
</section>
<section id="solar-wind-dm-delay">
<h2>Solar Wind DM Delay<a class="headerlink" href="#solar-wind-dm-delay" title="Link to this heading">#</a></h2>
<section id="r2-solar-wind-model">
<h3>1/r² Solar Wind Model<a class="headerlink" href="#r2-solar-wind-model" title="Link to this heading">#</a></h3>
<p>Model dispersion measure variations due to solar wind:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solardm_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_solardm</span><span class="p">(</span><span class="n">psr</span><span class="p">)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">solardm_func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;solardm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../api/solar.html#discovery.solar.make_solardm" title="discovery.solar.make_solardm"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_solardm()</span></code></a> and <a class="reference internal" href="../api/signals.html#discovery.signals.makedelay" title="discovery.signals.makedelay"><code class="xref py py-func docutils literal notranslate"><span class="pre">makedelay()</span></code></a>.</p>
<p>Implements a <span class="math notranslate nohighlight">\(1/r^2\)</span> solar wind density model. The delay function has signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solardm_func</span><span class="p">(</span><span class="n">n_earth</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">n_earth</span></code> is the electron density at Earth’s orbit (cm⁻³).</p>
<p><strong>Physical Model:</strong></p>
<p>The solar wind introduces a frequency-dependent delay:</p>
<div class="math notranslate nohighlight">
\[\Delta t(f) = \frac{n_{\mathrm{Earth}}}{f^2} \cdot \frac{\mathrm{AU}}{R_\oplus \sin(\theta_{\mathrm{impact}})} \cdot 4.148808 \times 10^3\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n_{\mathrm{Earth}}\)</span> is the electron density at 1 AU (free parameter)</p></li>
<li><p><span class="math notranslate nohighlight">\(R_\oplus\)</span> is Earth’s distance from the Sun</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_{\mathrm{impact}}\)</span> is the solar impact angle</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> is the observing frequency (MHz)</p></li>
</ul>
<p>The function pre-computes the geometric factors using the pulsar’s position and Earth’s ephemeris.</p>
<p><strong>Parameter:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{psrname}_solardm_n_earth</span></code>: Electron density at 1 AU (cm⁻³)</p></li>
</ul>
<p>Typical values: <span class="math notranslate nohighlight">\(n_{\mathrm{Earth}} \sim 5\)</span> cm⁻³.</p>
</section>
<section id="solar-wind-gp">
<h3>Solar Wind GP<a class="headerlink" href="#solar-wind-gp" title="Link to this heading">#</a></h3>
<p>For stochastic fluctuations on top of the deterministic model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add deterministic mean</span>
<span class="n">solardm_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_solardm</span><span class="p">(</span><span class="n">psr</span><span class="p">)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">solardm_func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;solardm&#39;</span><span class="p">)</span>

<span class="c1"># Add stochastic fluctuations</span>
<span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">fmat_sw</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_solardmfourierbasis</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">sw_gp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makegp_fourier</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">powerlaw</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                           <span class="n">fourierbasis</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">fmat_sw</span><span class="p">),</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sw_gp&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../api/solar.html#discovery.solar.make_solardmfourierbasis" title="discovery.solar.make_solardmfourierbasis"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_solardmfourierbasis()</span></code></a>, <a class="reference internal" href="../api/signals.html#discovery.signals.makegp_fourier" title="discovery.signals.makegp_fourier"><code class="xref py py-func docutils literal notranslate"><span class="pre">makegp_fourier()</span></code></a>,
and <a class="reference internal" href="../api/signals.html#discovery.signals.powerlaw" title="discovery.signals.powerlaw"><code class="xref py py-func docutils literal notranslate"><span class="pre">powerlaw()</span></code></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">make_solardmfourierbasis</span></code> function creates a Fourier basis scaled by the solar wind
geometry, so the GP represents fluctuations in <span class="math notranslate nohighlight">\(n_{\mathrm{Earth}}\)</span> around the mean.</p>
</section>
</section>
<section id="chromatic-delays">
<h2>Chromatic Delays<a class="headerlink" href="#chromatic-delays" title="Link to this heading">#</a></h2>
<section id="exponential-dip-model">
<h3>Exponential Dip Model<a class="headerlink" href="#exponential-dip-model" title="Link to this heading">#</a></h3>
<p>Model chromatic exponential dips - sudden radio frequency-dependent advances of pulse arrival times.
These events can impact measurements of time-correlated signals (see <a class="reference external" href="https://arxiv.org/abs/1909.08644">Hazboun et al. 2020</a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">decay_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_chromaticdelay</span><span class="p">(</span><span class="n">psr</span><span class="p">)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">decay_func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;chromatic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../api/solar.html#discovery.solar.make_chromaticdelay" title="discovery.solar.make_chromaticdelay"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_chromaticdelay()</span></code></a> and <a class="reference internal" href="../api/signals.html#discovery.signals.makedelay" title="discovery.signals.makedelay"><code class="xref py py-func docutils literal notranslate"><span class="pre">makedelay()</span></code></a>.</p>
<p>The delay function has signature:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">decay_func</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">log10_Amp</span><span class="p">,</span> <span class="n">log10_tau</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Physical Model:</strong></p>
<p>Implements an exponential decay with chromatic scaling:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta t(t, f) = \begin{cases}
-10^{\log_{10}(A)} \cdot e^{-(t - t_0) / \tau} \cdot \left(\frac{1400}{f}\right)^\alpha &amp; t &gt; t_0 \\
0 &amp; t \leq t_0
\end{cases}\end{split}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t_0\)</span> is the event time (MJD)</p></li>
<li><p><span class="math notranslate nohighlight">\(A = 10^{\log_{10}(A)}\)</span> is the amplitude (seconds at 1400 MHz)</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau = 10^{\log_{10}(\tau)}\)</span> is the decay timescale (days)</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the chromatic index (2 for DM, 4 for scattering)</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> is the observing frequency (MHz)</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{psrname}_chromatic_t0</span></code>: Event epoch (MJD)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{psrname}_chromatic_log10_Amp</span></code>: Log amplitude</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{psrname}_chromatic_log10_tau</span></code>: Log decay timescale (days)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{psrname}_chromatic_idx</span></code>: Chromatic index</p></li>
</ul>
<p><strong>Fixed Chromatic Index:</strong></p>
<p>To fix the chromatic index:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">decay_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_chromaticdelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># Fix to DM scaling</span>
</pre></div>
</div>
<p>This removes <code class="docutils literal notranslate"><span class="pre">idx</span></code> from the parameter list. See also <a class="reference internal" href="../api/solar.html#discovery.solar.chromaticdelay" title="discovery.solar.chromaticdelay"><code class="xref py py-func docutils literal notranslate"><span class="pre">chromaticdelay()</span></code></a>
for the underlying delay function.</p>
</section>
</section>
<section id="binary-black-hole-signals">
<h2>Binary Black Hole Signals<a class="headerlink" href="#binary-black-hole-signals" title="Link to this heading">#</a></h2>
<section id="continuous-wave-from-bbh">
<h3>Continuous Wave from BBH<a class="headerlink" href="#continuous-wave-from-bbh" title="Link to this heading">#</a></h3>
<p>Model deterministic signals from binary black hole systems:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># With pulsar term</span>
<span class="n">bbh_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay_binary</span><span class="p">(</span><span class="n">pulsarterm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">bbh_func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bbh&#39;</span><span class="p">)</span>

<span class="c1"># Without pulsar term (Earth term only)</span>
<span class="n">bbh_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay_binary</span><span class="p">(</span><span class="n">pulsarterm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">bbh_func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bbh&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../api/deterministic.html#discovery.deterministic.makedelay_binary" title="discovery.deterministic.makedelay_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">makedelay_binary()</span></code></a> and <a class="reference internal" href="../api/signals.html#discovery.signals.makedelay" title="discovery.signals.makedelay"><code class="xref py py-func docutils literal notranslate"><span class="pre">makedelay()</span></code></a>.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">log10_h0</span></code>: Log strain amplitude</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log10_f0</span></code>: Log GW frequency (Hz)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ra</span></code>: Right ascension (rad)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sindec</span></code>: Sine of declination</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cosinc</span></code>: Cosine of inclination angle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">psi</span></code>: Polarization angle (rad)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phi_earth</span></code>: Initial phase at Earth (rad)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phi_psr</span></code>: Initial phase at pulsar (rad, only if <code class="docutils literal notranslate"><span class="pre">pulsarterm=True</span></code>)</p></li>
</ul>
<p>The signal is computed using the Earth term (and optionally pulsar term) for a circular binary
emitting gravitational waves. Based on the formalism from Ellis et al. (2012, 2013).</p>
</section>
<section id="fourier-domain-bbh">
<h3>Fourier-Domain BBH<a class="headerlink" href="#fourier-domain-bbh" title="Link to this heading">#</a></h3>
<p>For signals in Fourier space (useful with FFTCov):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bbh_fourier</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makefourier_binary</span><span class="p">(</span><span class="n">pulsarterm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../api/deterministic.html#discovery.deterministic.makefourier_binary" title="discovery.deterministic.makefourier_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">makefourier_binary()</span></code></a>.</p>
<p>This computes the Fourier components directly, which can be more efficient for certain
likelihood computations.</p>
</section>
</section>
<section id="custom-delay-functions">
<h2>Custom Delay Functions<a class="headerlink" href="#custom-delay-functions" title="Link to this heading">#</a></h2>
<p>You can define custom JAX-compatible delay functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">quadratic_spindown</span><span class="p">(</span><span class="n">toas</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">pepoch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model timing noise as quadratic spindown.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    toas : array</span>
<span class="sd">        Times of arrival (seconds)</span>
<span class="sd">    f0 : float</span>
<span class="sd">        Spin frequency (Hz)</span>
<span class="sd">    f1 : float</span>
<span class="sd">        Spin frequency derivative (Hz/s)</span>
<span class="sd">    pepoch : float</span>
<span class="sd">        Reference epoch (MJD)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">toas</span> <span class="o">/</span> <span class="mf">86400.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">pepoch</span>  <span class="c1"># Convert to days</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f0</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">dt</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phase</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span><span class="p">)</span>  <span class="c1"># Convert phase to time</span>

<span class="c1"># Use in model</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">quadratic_spindown</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;spindown&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../api/signals.html#discovery.signals.makedelay" title="discovery.signals.makedelay"><code class="xref py py-func docutils literal notranslate"><span class="pre">makedelay()</span></code></a>.</p>
<p><strong>Requirements:</strong></p>
<ul class="simple">
<li><p>Must be JAX-compatible (use <code class="docutils literal notranslate"><span class="pre">jax.numpy</span></code> instead of <code class="docutils literal notranslate"><span class="pre">numpy</span></code>)</p></li>
<li><p>Must return delay in seconds with same shape as <code class="docutils literal notranslate"><span class="pre">toas</span></code></p></li>
<li><p>Pulsar attributes (<code class="docutils literal notranslate"><span class="pre">toas</span></code>, <code class="docutils literal notranslate"><span class="pre">freqs</span></code>, <code class="docutils literal notranslate"><span class="pre">pos</span></code>, etc.) can be first arguments</p></li>
<li><p>All operations must be differentiable for gradient-based inference</p></li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<section id="single-pulsar-with-solar-wind">
<h3>Single Pulsar with Solar Wind<a class="headerlink" href="#single-pulsar-with-solar-wind" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">discovery</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ds</span>

<span class="c1"># Load pulsar</span>
<span class="n">psr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">Pulsar</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s1">&#39;data/v1p1_de440_pint_bipm2019-B1855+09.feather&#39;</span><span class="p">)</span>

<span class="c1"># Solar wind delay</span>
<span class="n">solardm_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_solardm</span><span class="p">(</span><span class="n">psr</span><span class="p">)</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">solardm_func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;solardm&#39;</span><span class="p">)</span>

<span class="c1"># Build likelihood</span>
<span class="n">signals</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">psr</span><span class="o">.</span><span class="n">residuals</span><span class="p">,</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">makenoise_measurement</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">noisedict</span><span class="p">),</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">makegp_timing</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">svd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">makegp_fourier</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">powerlaw</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;rn&#39;</span><span class="p">),</span>
    <span class="n">delay</span>
<span class="p">]</span>

<span class="n">logl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">PulsarLikelihood</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span>

<span class="c1"># Parameters: rn_log10_A, rn_gamma, B1855+09_solardm_n_earth</span>
</pre></div>
</div>
</section>
<section id="multiple-chromatic-events">
<h3>Multiple Chromatic Events<a class="headerlink" href="#multiple-chromatic-events" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model two separate DM events</span>
<span class="n">decay1</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_chromaticdelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">delay1</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">decay1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dm_event1&#39;</span><span class="p">)</span>

<span class="n">decay2</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_chromaticdelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">delay2</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">decay2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dm_event2&#39;</span><span class="p">)</span>

<span class="n">signals</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">psr</span><span class="o">.</span><span class="n">residuals</span><span class="p">,</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">makenoise_measurement</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">noisedict</span><span class="p">),</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">makegp_timing</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">svd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">delay1</span><span class="p">,</span>
    <span class="n">delay2</span>
<span class="p">]</span>

<span class="n">logl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">PulsarLikelihood</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span>

<span class="c1"># Parameters include: dm_event1_t0, dm_event1_log10_Amp, dm_event1_log10_tau</span>
<span class="c1">#                     dm_event2_t0, dm_event2_log10_Amp, dm_event2_log10_tau</span>
</pre></div>
</div>
</section>
<section id="common-solar-wind-pta">
<h3>Common Solar Wind (PTA)<a class="headerlink" href="#common-solar-wind-pta" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shared n_earth across all pulsars</span>
<span class="n">delays</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">psr</span> <span class="ow">in</span> <span class="n">psrs</span><span class="p">:</span>
    <span class="n">solardm_func</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">make_solardm</span><span class="p">(</span><span class="n">psr</span><span class="p">)</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">makedelay</span><span class="p">(</span><span class="n">psr</span><span class="p">,</span> <span class="n">solardm_func</span><span class="p">,</span>
                        <span class="n">common</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n_earth&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;solardm&#39;</span><span class="p">)</span>
    <span class="n">delays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>

<span class="c1"># Build PTA likelihood</span>
<span class="n">gbl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GlobalLikelihood</span><span class="p">(</span><span class="n">psrs</span><span class="p">,</span> <span class="n">noisedict</span><span class="p">,</span> <span class="n">delays</span><span class="o">=</span><span class="n">delays</span><span class="p">)</span>

<span class="c1"># Single parameter: n_earth (shared across all pulsars)</span>
</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="noise_signals.html"><span class="doc">Noise and Signal Components</span></a> - Stochastic signal components</p></li>
<li><p><a class="reference internal" href="priors_spectra.html"><span class="doc">GP Priors and Spectra</span></a> - GP prior functions</p></li>
<li><p><a class="reference internal" href="../tutorials/basic_likelihood.html"><span class="doc">Basic Likelihood</span></a> - Building likelihoods</p></li>
<li><p><a class="reference internal" href="../api/signals.html"><span class="doc">signals</span></a> - Signals API reference</p></li>
<li><p><a class="reference internal" href="../api/solar.html"><span class="doc">solar</span></a> - Solar wind functions</p></li>
<li><p><a class="reference internal" href="../api/deterministic.html"><span class="doc">deterministic</span></a> - Deterministic signals API</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="priors_spectra.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">GP Priors and Spectra</p>
      </div>
    </a>
    <a class="right-next"
       href="../guide/data_model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data Model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-delay-functions">Creating Delay Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-makedelay-function">The <code class="docutils literal notranslate"><span class="pre">makedelay</span></code> Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solar-wind-dm-delay">Solar Wind DM Delay</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r2-solar-wind-model">1/r² Solar Wind Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solar-wind-gp">Solar Wind GP</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chromatic-delays">Chromatic Delays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exponential-dip-model">Exponential Dip Model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-black-hole-signals">Binary Black Hole Signals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-wave-from-bbh">Continuous Wave from BBH</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-domain-bbh">Fourier-Domain BBH</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-delay-functions">Custom Delay Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-pulsar-with-solar-wind">Single Pulsar with Solar Wind</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-chromatic-events">Multiple Chromatic Events</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-solar-wind-pta">Common Solar Wind (PTA)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#see-also">See Also</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/components/delays.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026, Michele Vallisneri.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>